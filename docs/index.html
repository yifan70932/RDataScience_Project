<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Wang, Yifan" />


<title>Evolution of Religious Population</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/simplex.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-4.5.0/css/font-awesome.min.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 41px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 46px;
  margin-top: -46px;
}

.section h2 {
  padding-top: 46px;
  margin-top: -46px;
}
.section h3 {
  padding-top: 46px;
  margin-top: -46px;
}
.section h4 {
  padding-top: 46px;
  margin-top: -46px;
}
.section h5 {
  padding-top: 46px;
  margin-top: -46px;
}
.section h6 {
  padding-top: 46px;
  margin-top: -46px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">R Data Science Final Project</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/adammwilson/RDataScience">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Evolution of Religious Population</h1>
<h3 class="subtitle"><em>Visualizing the Prediction of Major Religious Population Changing From 2010 to 2050</em></h3>
<h4 class="author"><em>Wang, Yifan</em></h4>

</div>


<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>With the advancement in science and the spreading of secularism, the problem of the necessaries of religions arises. Especially in younger generations, the ratio of people identified as believers stays low. In 2013, for example, only 9.6% of the Jewish population in the states are between age 18-24 while 11.7% of the U.S. population falls into the same age interval (Saxe and Tighe, 2013). And at the same time 25.6% of Jewish community are older than 65 years old while 19.2% of the U.S. population falls into the age section(Saxe and Tighe, 2013).</p>
<p>This project aims to provide a visualization of the changing in the religious and unreligious population to answer the following questions:</p>
<ol style="list-style-type: lower-alpha">
<li><strong>Which religion would experience the most rapid increasing of its follower group in the coming decades and</strong></li>
<li><strong>How would the spatial distribution of the religious population for different religions vary in the future.</strong></li>
</ol>
<p>The hypothesis towards this research is that religious population for all the major religions will increase while the community of skeptics would shrink. And regions with rapid populaion incresement may boost their local dominate religion’s population. With the data collected by the Global Religious Future project (<a href="http://globalreligiousfutures.org" class="uri">http://globalreligiousfutures.org</a>), the evolution, from the year 2010 to 2050, in the population of three major religions (i.e. Christianism, Islam and Buddhism) around the world is processed and displayed. The religious unaffiliated population, in addition, is visualized as well. In this project, a series of maps and graphs were produced to show the trend of the evolution of the religious population. With the result from the data processing, Islam would experience the most obvious increasing in the number of believers from now to the year 2050. While Buddhism and Christianity communities generally remain static in the coming decades. At the same time, the coming decades will witness the decreasing of the religious unaffiliated population comparing to the general trend of population growth.</p>
<blockquote>
<p><span style="color:blue">“Religion, it was thought, would thin out from its more robust, supernaturalist forms or die out altogether. But the theory that technological advancement brings inevitable secularization is now being scrapped or radically rethought.”</span> ~ Timothy Keller, &lt; the Reason for God &gt;</p>
</blockquote>
</div>
<div id="materials-and-methods" class="section level1">
<h1>Materials and Methods</h1>
<p>Using download.file() function to download the surveyed and estimated population for the believer community of</p>
<ul>
<li>Islam</li>
<li>Christianity</li>
<li>Buddhism</li>
<li>Religiously Unaffiliated</li>
</ul>
<p>from the <a href="http://globalreligiousfutures.org">The Global Religious Future Project</a>. You can visit the <a href="http://globalreligiousfutures.org/explorer#/?subtopic=15&amp;chartType=map&amp;year=2010&amp;data_type=number&amp;religious_affiliation=all&amp;destination=to&amp;countries=Worldwide&amp;age_group=all&amp;gender=all&amp;pdfMode=false">Data Explorer</a> for data about other religions.</p>
<div id="packages" class="section level2">
<h2>Packages</h2>
<pre class="r"><code>library(dplyr)
library(tidyr)
library(data.table)
library(rworldmap)
library(ggplot2)
library(maps)
library(spocc)
library(maptools)
library(RColorBrewer)
library(jsonlite)
library(geojsonio)
library(leaflet)
library(mapplots)
knitr::opts_chunk$set(cache = TRUE)</code></pre>
</div>
<div id="data-retrieving" class="section level2">
<h2>Data Retrieving</h2>
</div>
<div id="section" class="section level2 tabset tabset-fade tabset-pills">
<h2></h2>
<p>The dataset downloaded is the survey result in 234 countries and predictions made upon them (check <a href="http://globalreligiousfutures.org/explorer/about-grf-data" class="uri">http://globalreligiousfutures.org/explorer/about-grf-data</a> for more information). For each of the three representative religions, the number of believers in the year 2010, 2020, 2030, 2040 and 2050 is separately stored and downloaded in different datasets. The three religions mentioned above were selected to show the general trend of the variation of the religious population since that comparing to other religions that have large believer community, these three beliefs were more spread over the world so that could better represent the religious population community despite factors like politic or local culture.</p>
<p>The code following the download command read the data from the downloaded CSV file and create a data frame named as “Religion_Year” (e.g., Islam_2010) for every single dataset. The “skip” and “nrow” factor in the read.csv2() function serve to skip the description and space lines in the original file.</p>
<div id="islam" class="section level3">
<h3>Islam</h3>
<pre class="r"><code>## download the world Islam population data for 2010
download.file(&quot;http://globalreligiousfutures.org/csv/22411&quot;, &quot;muslim10.csv&quot;)
m10 &lt;- readLines(&quot;muslim10.csv&quot;)
islam_2010 &lt;- read.csv2(text = m10, sep = &quot;,&quot;, header = FALSE, skip = 11, col.names = c(&quot;Country_Code&quot;, 
    &quot;Country&quot;, &quot;Religion_Population&quot;), nrows = length(m10) - 16)

## download the world Islam population data for 2020
download.file(&quot;http://globalreligiousfutures.org/csv/21689&quot;, &quot;muslim20.csv&quot;)
m20 &lt;- readLines(&quot;muslim20.csv&quot;)
islam_2020 &lt;- read.csv2(text = m20, sep = &quot;,&quot;, header = FALSE, skip = 14, col.names = c(&quot;Country_Code&quot;, 
    &quot;Country&quot;, &quot;Religion_Population&quot;), nrows = length(m20) - 17)

## download the world Islam population data for 2030
download.file(&quot;http://globalreligiousfutures.org/csv/21688&quot;, &quot;muslim30.csv&quot;)
m30 &lt;- readLines(&quot;muslim30.csv&quot;)
islam_2030 &lt;- read.csv2(text = m30, sep = &quot;,&quot;, header = FALSE, skip = 11, col.names = c(&quot;Country_Code&quot;, 
    &quot;Country&quot;, &quot;Religion_Population&quot;), nrows = length(m30) - 14)

## download the world Islam population data for 2040
download.file(&quot;http://globalreligiousfutures.org/csv/21686&quot;, &quot;muslim40.csv&quot;)
m40 &lt;- readLines(&quot;muslim40.csv&quot;)
islam_2040 &lt;- read.csv2(text = m40, sep = &quot;,&quot;, header = FALSE, skip = 14, col.names = c(&quot;Country_Code&quot;, 
    &quot;Country&quot;, &quot;Religion_Population&quot;), nrows = length(m40) - 17)

## download the world Islam population data for 2050
download.file(&quot;http://globalreligiousfutures.org/csv/21662&quot;, &quot;muslim50.csv&quot;)
m50 &lt;- readLines(&quot;muslim50.csv&quot;)
islam_2050 &lt;- read.csv2(text = m50, sep = &quot;,&quot;, header = FALSE, skip = 3, col.names = c(&quot;Country_Code&quot;, 
    &quot;Country&quot;, &quot;Religion_Population&quot;), nrows = length(m50) - 6)</code></pre>
</div>
<div id="christianity" class="section level3">
<h3>Christianity</h3>
<pre class="r"><code>## download the world Christianity population data for 2010
download.file(&quot;http://globalreligiousfutures.org/csv/23086&quot;, &quot;crs10.csv&quot;)
c10 &lt;- readLines(&quot;crs10.csv&quot;)
chris_2010 &lt;- read.csv2(text = c10, 
                       sep = &quot;,&quot;, 
                       header = FALSE,
                       skip = 14,
                       col.names = c(&quot;Country_Code&quot;,&quot;Country&quot;,&quot;Religion_Population&quot;),
                       nrows = length(c10))

## download the world Christianity population data for 2020
download.file(&quot;http://globalreligiousfutures.org/csv/23071&quot;, &quot;crs20.csv&quot;)
c20 &lt;- readLines(&quot;crs20.csv&quot;)
chris_2020 &lt;- read.csv2(text = c20, 
                        sep = &quot;,&quot;, 
                        header = FALSE,
                        skip = 11,
                        col.names = c(&quot;Country_Code&quot;,&quot;Country&quot;,&quot;Religion_Population&quot;),
                        nrows = length(c20) - 14)

## download the world Christianity population data for 2030
download.file(&quot;http://globalreligiousfutures.org/csv/23072&quot;, &quot;crs30.csv&quot;)
c30 &lt;- readLines(&quot;crs30.csv&quot;)
chris_2030 &lt;- read.csv2(text = c30, 
                        sep = &quot;,&quot;, 
                        header = FALSE,
                        skip = 11,
                        col.names = c(&quot;Country_Code&quot;,&quot;Country&quot;,&quot;Religion_Population&quot;),
                        nrows = length(c30) - 14)

## download the world Christianity population data for 2040
download.file(&quot;http://globalreligiousfutures.org/csv/23073&quot;, &quot;crs40.csv&quot;)
c40 &lt;- readLines(&quot;crs40.csv&quot;)
chris_2040 &lt;- read.csv2(text = c40, 
                        sep = &quot;,&quot;, 
                        header = FALSE,
                        skip = 11,
                        col.names = c(&quot;Country_Code&quot;,&quot;Country&quot;,&quot;Religion_Population&quot;),
                        nrows = length(c40) - 14)

## download the world Christianity population data for 2050
download.file(&quot;http://globalreligiousfutures.org/csv/23074&quot;, &quot;crs50.csv&quot;)
c50 &lt;- readLines(&quot;crs50.csv&quot;)
chris_2050 &lt;- read.csv2(text = c50, 
                        sep = &quot;,&quot;, 
                        header = FALSE,
                        skip = 11,
                        col.names = c(&quot;Country_Code&quot;,&quot;Country&quot;,&quot;Religion_Population&quot;),
                        nrows = length(c50) - 14)</code></pre>
</div>
<div id="buddahism" class="section level3">
<h3>Buddahism</h3>
<pre class="r"><code>## download the world Buddahism population data for 2010
download.file(&quot;http://globalreligiousfutures.org/csv/22196&quot;, &quot;buda10.csv&quot;)
b10 &lt;- readLines(&quot;buda10.csv&quot;)
buddha_2010 &lt;- read.csv2(text = b10, 
                        sep = &quot;,&quot;, 
                        header = FALSE,
                        skip = 11,
                        col.names = c(&quot;Country_Code&quot;,&quot;Country&quot;,&quot;Religion_Population&quot;),
                        nrows = length(b10) - 16)

## download the world Buddahism population data for 2020
download.file(&quot;http://globalreligiousfutures.org/csv/22885&quot;, &quot;buda20.csv&quot;)
b20 &lt;- readLines(&quot;buda20.csv&quot;)
buddha_2020 &lt;- read.csv2(text = b20, 
                         sep = &quot;,&quot;, 
                         header = FALSE,
                         skip = 11,
                         col.names = c(&quot;Country_Code&quot;,&quot;Country&quot;,&quot;Religion_Population&quot;),
                         nrows = length(b20) - 14)

## download the world Buddahism population data for 2030
download.file(&quot;http://globalreligiousfutures.org/csv/23075&quot;, &quot;buda30.csv&quot;)
b30 &lt;- readLines(&quot;buda30.csv&quot;)
buddha_2030 &lt;- read.csv2(text = b30, 
                         sep = &quot;,&quot;, 
                         header = FALSE,
                         skip = 11,
                         col.names = c(&quot;Country_Code&quot;,&quot;Country&quot;,&quot;Religion_Population&quot;),
                         nrows = length(b30) - 16)

## download the world Buddahism population data for 2040
download.file(&quot;http://globalreligiousfutures.org/csv/23076&quot;, &quot;buda40.csv&quot;)
b40 &lt;- readLines(&quot;buda40.csv&quot;)
buddha_2040 &lt;- read.csv2(text = b40, 
                         sep = &quot;,&quot;, 
                         header = FALSE,
                         skip = 11,
                         col.names = c(&quot;Country_Code&quot;,&quot;Country&quot;,&quot;Religion_Population&quot;),
                         nrows = length(b40) - 14)

## download the world Buddahism population data for 2050
download.file(&quot;http://globalreligiousfutures.org/csv/23077&quot;, &quot;buda50.csv&quot;)
b50 &lt;- readLines(&quot;buda50.csv&quot;)
buddha_2050 &lt;- read.csv2(text = b50, 
                         sep = &quot;,&quot;, 
                         header = FALSE,
                         skip = 11,
                         col.names = c(&quot;Country_Code&quot;,&quot;Country&quot;,&quot;Religion_Population&quot;),
                         nrows = length(b50) - 14)</code></pre>
</div>
<div id="religiously-unaffiliated" class="section level3">
<h3>Religiously Unaffiliated</h3>
<pre class="r"><code>## download the world religious unaffiliated population data for 2010
download.file(&quot;http://globalreligiousfutures.org/csv/23117&quot;, &quot;unaf10.csv&quot;)
u10 &lt;- readLines(&quot;unaf10.csv&quot;)
unaffiliated_2010 &lt;- read.csv2(text = u10, 
                               sep = &quot;,&quot;, 
                               header = FALSE,
                               skip = 11,
                               col.names = c(&quot;Country_Code&quot;,&quot;Country&quot;,&quot;Religion_Population&quot;),
                               nrows = length(u10) - 14)

## download the world religious unaffiliated population data for 2020
download.file(&quot;http://globalreligiousfutures.org/csv/23079&quot;, &quot;unaf20.csv&quot;)
u20 &lt;- readLines(&quot;unaf20.csv&quot;)
unaffiliated_2020 &lt;- read.csv2(text = u20, 
                               sep = &quot;,&quot;, 
                               header = FALSE,
                               skip = 11,
                               col.names = c(&quot;Country_Code&quot;,&quot;Country&quot;,&quot;Religion_Population&quot;),
                               nrows = length(u20) - 14)

## download the world religious unaffiliated population data for 2030
download.file(&quot;http://globalreligiousfutures.org/csv/23080&quot;, &quot;unaf30.csv&quot;)
u30 &lt;- readLines(&quot;unaf30.csv&quot;)
unaffiliated_2030 &lt;- read.csv2(text = u30, 
                               sep = &quot;,&quot;, 
                               header = FALSE,
                               skip = 11,
                               col.names = c(&quot;Country_Code&quot;,&quot;Country&quot;,&quot;Religion_Population&quot;),
                               nrows = length(u30) - 14)

## download the world religious unaffiliated population data for 2040
download.file(&quot;http://globalreligiousfutures.org/csv/23081&quot;, &quot;unaf40.csv&quot;)
u40 &lt;- readLines(&quot;unaf40.csv&quot;)
unaffiliated_2040 &lt;- read.csv2(text = u40, 
                               sep = &quot;,&quot;, 
                               header = FALSE,
                               skip = 11,
                               col.names = c(&quot;Country_Code&quot;,&quot;Country&quot;,&quot;Religion_Population&quot;),
                               nrows = length(u40) - 14)

## download the world religious unaffiliated population data for 2050
download.file(&quot;http://globalreligiousfutures.org/csv/23082&quot;, &quot;unaf50.csv&quot;)
u50 &lt;- readLines(&quot;unaf50.csv&quot;)
unaffiliated_2050 &lt;- read.csv2(text = u50, 
                               sep = &quot;,&quot;, 
                               header = FALSE,
                               skip = 11,
                               col.names = c(&quot;Country_Code&quot;,&quot;Country&quot;,&quot;Religion_Population&quot;),
                               nrows = length(u50) - 14)</code></pre>
</div>
</div>
<div id="data-processing" class="section level2">
<h2>Data Processing</h2>
</div>
<div id="section-1" class="section level2 tabset">
<h2></h2>
<p>The data processing for each religion is showed in this section.</p>
<div id="spatial-polygon-data-frame" class="section level3">
<h3>Spatial Polygon Data Frame</h3>
<p>The column of ISO code for each country is first stored as a character variable, and the population column is stored separately as a numeric variable. Then these two sets of values are joined together into a data frame.</p>
<p>The joinCountryData2Map function turns the data frame into a spatial polygon data frame by specifying the “joincode”, which is the ISO2 code in our scenario.</p>
<pre class="r"><code>Islam_2010_iso &lt;- as.character(islam_2010$Country_Code)
Islam_2010_Population &lt;- as.numeric(gsub(&quot;,&quot;,&quot;&quot;,as.character(islam_2010$Religion_Population)))
islam_2010_plot &lt;- joinCountryData2Map(data.frame(country_iso = Islam_2010_iso, 
                                                  value = Islam_2010_Population), 
                                       joinCode = &quot;ISO2&quot;, 
                                       nameJoinColumn = &quot;country_iso&quot;)</code></pre>
<pre><code>## 224 codes from your data successfully matched countries in the map
## 11 codes from your data failed to match with a country code in the map
## 17 codes from the map weren&#39;t represented in your data</code></pre>
<pre class="r"><code>chris_2010_iso &lt;- as.character(chris_2010$Country_Code)
chris_2010_Population &lt;- as.numeric(gsub(&quot;,&quot;,&quot;&quot;,as.character(chris_2010$Religion_Population)))
chris_2010_plot &lt;- joinCountryData2Map(data.frame(country_iso = chris_2010_iso, 
                                                  value = chris_2010_Population), 
                                       joinCode = &quot;ISO2&quot;, 
                                       nameJoinColumn = &quot;country_iso&quot;)</code></pre>
<pre><code>## 1120 codes from your data successfully matched countries in the map
## 78 codes from your data failed to match with a country code in the map
## 17 codes from the map weren&#39;t represented in your data</code></pre>
<pre class="r"><code>buddha_2010_iso &lt;- as.character(buddha_2010$Country_Code)
buddha_2010_Population &lt;- as.numeric(gsub(&quot;,&quot;,&quot;&quot;,as.character(buddha_2010$Religion_Population)))
buddha_2010_plot &lt;- joinCountryData2Map(data.frame(country_iso = buddha_2010_iso, 
                                                  value = buddha_2010_Population), 
                                       joinCode = &quot;ISO2&quot;, 
                                       nameJoinColumn = &quot;country_iso&quot;)</code></pre>
<pre><code>## 224 codes from your data successfully matched countries in the map
## 11 codes from your data failed to match with a country code in the map
## 17 codes from the map weren&#39;t represented in your data</code></pre>
<pre class="r"><code>unaffiliated_2010_iso &lt;- as.character(unaffiliated_2010$Country_Code)
unaffiliated_2010_Population &lt;- as.numeric(gsub(&quot;,&quot;,&quot;&quot;,as.character(unaffiliated_2010$Religion_Population)))
unaffiliated_2010_plot &lt;- joinCountryData2Map(data.frame(country_iso = unaffiliated_2010_iso, 
                                                  value = unaffiliated_2010_Population), 
                                       joinCode = &quot;ISO2&quot;, 
                                       nameJoinColumn = &quot;country_iso&quot;)</code></pre>
<pre><code>## 221 codes from your data successfully matched countries in the map
## 16 codes from your data failed to match with a country code in the map
## 20 codes from the map weren&#39;t represented in your data</code></pre>
<pre class="r"><code>Islam_2020_iso &lt;- as.character(islam_2020$Country_Code)
Islam_2020_Population &lt;- as.numeric(gsub(&quot;,&quot;,&quot;&quot;,as.character(islam_2020$Religion_Population)))
islam_2020_plot &lt;- joinCountryData2Map(data.frame(country_iso = Islam_2020_iso, 
                                                  value = Islam_2020_Population), 
                                       joinCode = &quot;ISO2&quot;, 
                                       nameJoinColumn = &quot;country_iso&quot;)</code></pre>
<pre><code>## 224 codes from your data successfully matched countries in the map
## 10 codes from your data failed to match with a country code in the map
## 17 codes from the map weren&#39;t represented in your data</code></pre>
<pre class="r"><code>chris_2020_iso &lt;- as.character(chris_2020$Country_Code)
chris_2020_Population &lt;- as.numeric(gsub(&quot;,&quot;,&quot;&quot;,as.character(chris_2020$Religion_Population)))
chris_2020_plot &lt;- joinCountryData2Map(data.frame(country_iso = chris_2020_iso, 
                                                  value = chris_2020_Population), 
                                       joinCode = &quot;ISO2&quot;, 
                                       nameJoinColumn = &quot;country_iso&quot;)</code></pre>
<pre><code>## 224 codes from your data successfully matched countries in the map
## 13 codes from your data failed to match with a country code in the map
## 17 codes from the map weren&#39;t represented in your data</code></pre>
<pre class="r"><code>buddha_2020_iso &lt;- as.character(buddha_2020$Country_Code)
buddha_2020_Population &lt;- as.numeric(gsub(&quot;,&quot;,&quot;&quot;,as.character(buddha_2020$Religion_Population)))
buddha_2020_plot &lt;- joinCountryData2Map(data.frame(country_iso = buddha_2020_iso, 
                                                  value = buddha_2020_Population), 
                                       joinCode = &quot;ISO2&quot;, 
                                       nameJoinColumn = &quot;country_iso&quot;)</code></pre>
<pre><code>## 224 codes from your data successfully matched countries in the map
## 13 codes from your data failed to match with a country code in the map
## 17 codes from the map weren&#39;t represented in your data</code></pre>
<pre class="r"><code>unaffiliated_2020_iso &lt;- as.character(unaffiliated_2020$Country_Code)
unaffiliated_2020_Population &lt;- as.numeric(gsub(&quot;,&quot;,&quot;&quot;,as.character(unaffiliated_2020$Religion_Population)))
unaffiliated_2020_plot &lt;- joinCountryData2Map(data.frame(country_iso = unaffiliated_2020_iso, 
                                                  value = unaffiliated_2020_Population), 
                                       joinCode = &quot;ISO2&quot;, 
                                       nameJoinColumn = &quot;country_iso&quot;)</code></pre>
<pre><code>## 224 codes from your data successfully matched countries in the map
## 13 codes from your data failed to match with a country code in the map
## 17 codes from the map weren&#39;t represented in your data</code></pre>
<pre class="r"><code>Islam_2030_iso &lt;- as.character(islam_2030$Country_Code)
Islam_2030_Population &lt;- as.numeric(gsub(&quot;,&quot;,&quot;&quot;,as.character(islam_2030$Religion_Population)))
islam_2030_plot &lt;- joinCountryData2Map(data.frame(country_iso = Islam_2030_iso, 
                                                  value = Islam_2030_Population), 
                                       joinCode = &quot;ISO2&quot;, 
                                       nameJoinColumn = &quot;country_iso&quot;)</code></pre>
<pre><code>## 224 codes from your data successfully matched countries in the map
## 13 codes from your data failed to match with a country code in the map
## 17 codes from the map weren&#39;t represented in your data</code></pre>
<pre class="r"><code>chris_2030_iso &lt;- as.character(chris_2030$Country_Code)
chris_2030_Population &lt;- as.numeric(gsub(&quot;,&quot;,&quot;&quot;,as.character(chris_2030$Religion_Population)))
chris_2030_plot &lt;- joinCountryData2Map(data.frame(country_iso = chris_2030_iso, 
                                                  value = chris_2030_Population), 
                                       joinCode = &quot;ISO2&quot;, 
                                       nameJoinColumn = &quot;country_iso&quot;)</code></pre>
<pre><code>## 224 codes from your data successfully matched countries in the map
## 13 codes from your data failed to match with a country code in the map
## 17 codes from the map weren&#39;t represented in your data</code></pre>
<pre class="r"><code>buddha_2030_iso &lt;- as.character(buddha_2030$Country_Code)
buddha_2030_Population &lt;- as.numeric(gsub(&quot;,&quot;,&quot;&quot;,as.character(buddha_2030$Religion_Population)))
buddha_2030_plot &lt;- joinCountryData2Map(data.frame(country_iso = buddha_2030_iso, 
                                                  value = buddha_2030_Population), 
                                       joinCode = &quot;ISO2&quot;, 
                                       nameJoinColumn = &quot;country_iso&quot;)</code></pre>
<pre><code>## 223 codes from your data successfully matched countries in the map
## 12 codes from your data failed to match with a country code in the map
## 18 codes from the map weren&#39;t represented in your data</code></pre>
<pre class="r"><code>unaffiliated_2030_iso &lt;- as.character(unaffiliated_2030$Country_Code)
unaffiliated_2030_Population &lt;- as.numeric(gsub(&quot;,&quot;,&quot;&quot;,as.character(unaffiliated_2030$Religion_Population)))
unaffiliated_2030_plot &lt;- joinCountryData2Map(data.frame(country_iso = unaffiliated_2030_iso, 
                                                  value = unaffiliated_2030_Population), 
                                       joinCode = &quot;ISO2&quot;, 
                                       nameJoinColumn = &quot;country_iso&quot;)</code></pre>
<pre><code>## 224 codes from your data successfully matched countries in the map
## 13 codes from your data failed to match with a country code in the map
## 17 codes from the map weren&#39;t represented in your data</code></pre>
<pre class="r"><code>Islam_2040_iso &lt;- as.character(islam_2040$Country_Code)
Islam_2040_Population &lt;- as.numeric(gsub(&quot;,&quot;,&quot;&quot;,as.character(islam_2040$Religion_Population)))
islam_2040_plot &lt;- joinCountryData2Map(data.frame(country_iso = Islam_2040_iso, 
                                                  value = Islam_2040_Population), 
                                       joinCode = &quot;ISO2&quot;, 
                                       nameJoinColumn = &quot;country_iso&quot;)</code></pre>
<pre><code>## 224 codes from your data successfully matched countries in the map
## 10 codes from your data failed to match with a country code in the map
## 17 codes from the map weren&#39;t represented in your data</code></pre>
<pre class="r"><code>chris_2040_iso &lt;- as.character(chris_2040$Country_Code)
chris_2040_Population &lt;- as.numeric(gsub(&quot;,&quot;,&quot;&quot;,as.character(chris_2040$Religion_Population)))
chris_2040_plot &lt;- joinCountryData2Map(data.frame(country_iso = chris_2040_iso, 
                                                  value = chris_2040_Population), 
                                       joinCode = &quot;ISO2&quot;, 
                                       nameJoinColumn = &quot;country_iso&quot;)</code></pre>
<pre><code>## 224 codes from your data successfully matched countries in the map
## 13 codes from your data failed to match with a country code in the map
## 17 codes from the map weren&#39;t represented in your data</code></pre>
<pre class="r"><code>buddha_2040_iso &lt;- as.character(buddha_2040$Country_Code)
buddha_2040_Population &lt;- as.numeric(gsub(&quot;,&quot;,&quot;&quot;,as.character(buddha_2040$Religion_Population)))
buddha_2040_plot &lt;- joinCountryData2Map(data.frame(country_iso = buddha_2040_iso, 
                                                  value = buddha_2040_Population), 
                                       joinCode = &quot;ISO2&quot;, 
                                       nameJoinColumn = &quot;country_iso&quot;)</code></pre>
<pre><code>## 224 codes from your data successfully matched countries in the map
## 13 codes from your data failed to match with a country code in the map
## 17 codes from the map weren&#39;t represented in your data</code></pre>
<pre class="r"><code>unaffiliated_2040_iso &lt;- as.character(unaffiliated_2040$Country_Code)
unaffiliated_2040_Population &lt;- as.numeric(gsub(&quot;,&quot;,&quot;&quot;,as.character(unaffiliated_2040$Religion_Population)))
unaffiliated_2040_plot &lt;- joinCountryData2Map(data.frame(country_iso = unaffiliated_2040_iso, 
                                                  value = unaffiliated_2040_Population), 
                                       joinCode = &quot;ISO2&quot;, 
                                       nameJoinColumn = &quot;country_iso&quot;)</code></pre>
<pre><code>## 224 codes from your data successfully matched countries in the map
## 13 codes from your data failed to match with a country code in the map
## 17 codes from the map weren&#39;t represented in your data</code></pre>
<pre class="r"><code>Islam_2050_iso &lt;- as.character(islam_2050$Country_Code)
Islam_2050_Population &lt;- as.numeric(gsub(&quot;,&quot;,&quot;&quot;,as.character(islam_2050$Religion_Population)))
islam_2050_plot &lt;- joinCountryData2Map(data.frame(country_iso = Islam_2050_iso, 
                                                  value = Islam_2050_Population), 
                                       joinCode = &quot;ISO2&quot;, 
                                       nameJoinColumn = &quot;country_iso&quot;)</code></pre>
<pre><code>## 224 codes from your data successfully matched countries in the map
## 21 codes from your data failed to match with a country code in the map
## 17 codes from the map weren&#39;t represented in your data</code></pre>
<pre class="r"><code>chris_2050_iso &lt;- as.character(chris_2050$Country_Code)
chris_2050_Population &lt;- as.numeric(gsub(&quot;,&quot;,&quot;&quot;,as.character(chris_2050$Religion_Population)))
chris_2050_plot &lt;- joinCountryData2Map(data.frame(country_iso = chris_2050_iso, 
                                                  value = chris_2050_Population), 
                                       joinCode = &quot;ISO2&quot;, 
                                       nameJoinColumn = &quot;country_iso&quot;)</code></pre>
<pre><code>## 221 codes from your data successfully matched countries in the map
## 16 codes from your data failed to match with a country code in the map
## 20 codes from the map weren&#39;t represented in your data</code></pre>
<pre class="r"><code>buddha_2050_iso &lt;- as.character(buddha_2050$Country_Code)
buddha_2050_Population &lt;- as.numeric(gsub(&quot;,&quot;,&quot;&quot;,as.character(buddha_2050$Religion_Population)))
buddha_2050_plot &lt;- joinCountryData2Map(data.frame(country_iso = buddha_2050_iso, 
                                                  value = buddha_2050_Population), 
                                       joinCode = &quot;ISO2&quot;, 
                                       nameJoinColumn = &quot;country_iso&quot;)</code></pre>
<pre><code>## 221 codes from your data successfully matched countries in the map
## 16 codes from your data failed to match with a country code in the map
## 20 codes from the map weren&#39;t represented in your data</code></pre>
<pre class="r"><code>unaffiliated_2050_iso &lt;- as.character(unaffiliated_2050$Country_Code)
unaffiliated_2050_Population &lt;- as.numeric(gsub(&quot;,&quot;,&quot;&quot;,as.character(unaffiliated_2050$Religion_Population)))
unaffiliated_2050_plot &lt;- joinCountryData2Map(data.frame(country_iso = unaffiliated_2050_iso, 
                                                  value = unaffiliated_2050_Population), 
                                       joinCode = &quot;ISO2&quot;, 
                                       nameJoinColumn = &quot;country_iso&quot;)</code></pre>
<pre><code>## 221 codes from your data successfully matched countries in the map
## 16 codes from your data failed to match with a country code in the map
## 20 codes from the map weren&#39;t represented in your data</code></pre>
</div>
<div id="assembling" class="section level3">
<h3>Assembling</h3>
<p>This section provides the data frame for line chart and other statistical graphs. The raw data sets are copied and renamed the column of religion population to include the year for the merging operation. Five data frame are merged simultaneously by Reduce() function; the function provides a so-called “for-each” loop to iterate through all the data frames in the list() function.</p>
<pre class="r"><code>Islam_2020_Population &lt;- as.numeric(gsub(&quot;,&quot;,&quot;&quot;,as.character(islam_2020$Religion_Population)))
Islam_2030_Population &lt;- as.numeric(gsub(&quot;,&quot;,&quot;&quot;,as.character(islam_2030$Religion_Population)))
Islam_2040_Population &lt;- as.numeric(gsub(&quot;,&quot;,&quot;&quot;,as.character(islam_2040$Religion_Population)))

islam_total_2010 &lt;- sum(Islam_2010_Population, na.rm = TRUE)
islam_total_2020 &lt;- sum(Islam_2020_Population, na.rm = TRUE)
islam_total_2030 &lt;- sum(Islam_2030_Population, na.rm = TRUE)
islam_total_2040 &lt;- sum(Islam_2040_Population, na.rm = TRUE)
islam_total_2050 &lt;- sum(Islam_2050_Population, na.rm = TRUE)

chris_2020_Population &lt;- as.numeric(gsub(&quot;,&quot;,&quot;&quot;,as.character(chris_2020$Religion_Population)))
chris_2030_Population &lt;- as.numeric(gsub(&quot;,&quot;,&quot;&quot;,as.character(chris_2030$Religion_Population)))
chris_2040_Population &lt;- as.numeric(gsub(&quot;,&quot;,&quot;&quot;,as.character(chris_2040$Religion_Population)))

chris_total_2020 &lt;- sum(chris_2020_Population, na.rm = TRUE)
chris_total_2030 &lt;- sum(chris_2030_Population, na.rm = TRUE)
chris_total_2040 &lt;- sum(chris_2040_Population, na.rm = TRUE)
chris_total_2050 &lt;- sum(chris_2050_Population, na.rm = TRUE)


buddha_2020_Population &lt;- as.numeric(gsub(&quot;,&quot;,&quot;&quot;,as.character(buddha_2020$Religion_Population)))
buddha_2030_Population &lt;- as.numeric(gsub(&quot;,&quot;,&quot;&quot;,as.character(buddha_2030$Religion_Population)))
buddha_2040_Population &lt;- as.numeric(gsub(&quot;,&quot;,&quot;&quot;,as.character(buddha_2040$Religion_Population)))

buddha_total_2010 &lt;- sum(buddha_2010_Population, na.rm = TRUE)
buddha_total_2020 &lt;- sum(buddha_2020_Population, na.rm = TRUE)
buddha_total_2030 &lt;- sum(buddha_2030_Population, na.rm = TRUE)
buddha_total_2040 &lt;- sum(buddha_2040_Population, na.rm = TRUE)
buddha_total_2050 &lt;- sum(buddha_2050_Population, na.rm = TRUE)

unaffiliated_2020_Population &lt;- as.numeric(gsub(&quot;,&quot;,&quot;&quot;,as.character(unaffiliated_2020$Religion_Population)))
unaffiliated_2030_Population &lt;- as.numeric(gsub(&quot;,&quot;,&quot;&quot;,as.character(unaffiliated_2030$Religion_Population)))
unaffiliated_2040_Population &lt;- as.numeric(gsub(&quot;,&quot;,&quot;&quot;,as.character(unaffiliated_2040$Religion_Population)))

unaffiliated_total_2010 &lt;- sum(unaffiliated_2010_Population, na.rm = TRUE)
unaffiliated_total_2020 &lt;- sum(unaffiliated_2020_Population, na.rm = TRUE)
unaffiliated_total_2030 &lt;- sum(unaffiliated_2030_Population, na.rm = TRUE)
unaffiliated_total_2040 &lt;- sum(unaffiliated_2040_Population, na.rm = TRUE)
unaffiliated_total_2050 &lt;- sum(unaffiliated_2050_Population, na.rm = TRUE)

#make table
total_1050 &lt;- matrix(c(islam_total_2010,chris_total_2020,buddha_total_2010,unaffiliated_total_2010,islam_total_2020,chris_total_2020,buddha_total_2020,unaffiliated_total_2020,islam_total_2030,chris_total_2030,buddha_total_2030,unaffiliated_total_2030,islam_total_2040,chris_total_2040,buddha_total_2040,unaffiliated_total_2040,islam_total_2050,chris_total_2050,buddha_total_2050,unaffiliated_total_2050), ncol = 4, byrow = TRUE)

colnames(total_1050) &lt;- c(&quot;Islam&quot;, &quot;Christianity&quot;, &quot;Buddhism&quot;, &quot;Religious Unaffiliated&quot;)
rownames(total_1050) &lt;- c(&quot;2010&quot;, &quot;2020&quot;, &quot;2030&quot;, &quot;2040&quot;, &quot;2050&quot;)

total_1050 &lt;- as.table(total_1050)

islam_evolusion &lt;- c(islam_total_2010,islam_total_2020,islam_total_2030,islam_total_2040,islam_total_2050)





islam_2010_graph &lt;- islam_2010
colnames(islam_2010_graph) &lt;- c(&quot;Country_Code&quot;, &quot;Country&quot;, &quot;Religion_Population_2010&quot;)

islam_2020_graph &lt;- islam_2020
colnames(islam_2020_graph) &lt;- c(&quot;Country_Code&quot;, &quot;Country&quot;, &quot;Religion_Population_2020&quot;)

islam_2030_graph &lt;- islam_2030
colnames(islam_2030_graph) &lt;- c(&quot;Country_Code&quot;, &quot;Country&quot;, &quot;Religion_Population_2030&quot;)

islam_2040_graph &lt;- islam_2040
colnames(islam_2040_graph) &lt;- c(&quot;Country_Code&quot;, &quot;Country&quot;, &quot;Religion_Population_2040&quot;)

islam_2050_graph &lt;- islam_2050
colnames(islam_2050_graph) &lt;- c(&quot;Country_Code&quot;, &quot;Country&quot;, &quot;Religion_Population_2050&quot;)

islam_10_50 &lt;- Reduce(function(x,y) 
  merge(x, y, by = &quot;Country&quot;), 
  list(islam_2010_graph, islam_2020_graph, islam_2030_graph, islam_2040_graph, islam_2050_graph))


chris_2010_graph &lt;- chris_2010
colnames(chris_2010_graph) &lt;- c(&quot;Country_Code&quot;, &quot;Country&quot;, &quot;Religion_Population_2010&quot;)
chris_2020_graph &lt;- chris_2020
colnames(chris_2020_graph) &lt;- c(&quot;Country_Code&quot;, &quot;Country&quot;, &quot;Religion_Population_2020&quot;)
chris_2030_graph &lt;- chris_2030
colnames(chris_2030_graph) &lt;- c(&quot;Country_Code&quot;, &quot;Country&quot;, &quot;Religion_Population_2030&quot;)
chris_2040_graph &lt;- chris_2040
colnames(chris_2040_graph) &lt;- c(&quot;Country_Code&quot;, &quot;Country&quot;, &quot;Religion_Population_2040&quot;)
chris_2050_graph &lt;- chris_2050
colnames(chris_2050_graph) &lt;- c(&quot;Country_Code&quot;, &quot;Country&quot;, &quot;Religion_Population_2050&quot;)

chris_10_50 &lt;- Reduce(function(x,y) 
  merge(x, y, by = &quot;Country&quot;), 
  list(chris_2010_graph, chris_2020_graph, chris_2030_graph, chris_2040_graph, chris_2050_graph))

chris_20_50 &lt;- Reduce(function(x,y) 
  merge(x, y, by = &quot;Country&quot;), 
  list(chris_2020_graph, chris_2030_graph, chris_2040_graph, chris_2050_graph))

buddha_2010_graph &lt;- buddha_2010
colnames(buddha_2010_graph) &lt;- c(&quot;Country_Code&quot;, &quot;Country&quot;, &quot;Religion_Population_2010&quot;)
buddha_2020_graph &lt;- buddha_2020
colnames(buddha_2020_graph) &lt;- c(&quot;Country_Code&quot;, &quot;Country&quot;, &quot;Religion_Population_2020&quot;)
buddha_2030_graph &lt;- buddha_2030
colnames(buddha_2030_graph) &lt;- c(&quot;Country_Code&quot;, &quot;Country&quot;, &quot;Religion_Population_2030&quot;)
buddha_2040_graph &lt;- buddha_2040
colnames(buddha_2040_graph) &lt;- c(&quot;Country_Code&quot;, &quot;Country&quot;, &quot;Religion_Population_2040&quot;)
buddha_2050_graph &lt;- buddha_2050
colnames(buddha_2050_graph) &lt;- c(&quot;Country_Code&quot;, &quot;Country&quot;, &quot;Religion_Population_2050&quot;)

buddha_10_50 &lt;- Reduce(function(x,y) 
  merge(x, y, by = &quot;Country&quot;), 
  list(buddha_2010_graph, buddha_2020_graph, buddha_2030_graph, buddha_2040_graph, buddha_2050_graph))

unaffiliated_2010_graph &lt;- unaffiliated_2010
colnames(unaffiliated_2010_graph) &lt;- c(&quot;Country_Code&quot;, &quot;Country&quot;, &quot;Religion_Population_2010&quot;)
unaffiliated_2020_graph &lt;- unaffiliated_2020
colnames(unaffiliated_2020_graph) &lt;- c(&quot;Country_Code&quot;, &quot;Country&quot;, &quot;Religion_Population_2020&quot;)
unaffiliated_2030_graph &lt;- unaffiliated_2030
colnames(unaffiliated_2030_graph) &lt;- c(&quot;Country_Code&quot;, &quot;Country&quot;, &quot;Religion_Population_2030&quot;)
unaffiliated_2040_graph &lt;- unaffiliated_2040
colnames(unaffiliated_2040_graph) &lt;- c(&quot;Country_Code&quot;, &quot;Country&quot;, &quot;Religion_Population_2040&quot;)
unaffiliated_2050_graph &lt;- unaffiliated_2050
colnames(unaffiliated_2050_graph) &lt;- c(&quot;Country_Code&quot;, &quot;Country&quot;, &quot;Religion_Population_2050&quot;)

unaffiliated_10_50 &lt;- Reduce(function(x,y) 
  merge(x, y, by = &quot;Country&quot;), 
  list(unaffiliated_2010_graph, unaffiliated_2020_graph, unaffiliated_2030_graph, unaffiliated_2040_graph, unaffiliated_2050_graph))</code></pre>
</div>
</div>
</div>
<div id="results" class="section level1">
<h1>Results</h1>
<div id="choropleth" class="section level2">
<h2>Choropleth</h2>
</div>
<div id="section-2" class="section level2 tabset">
<h2></h2>
<p>In this part, a simple choropleth visualization is performed. To save space, only the religious population in the year 2010 and 2050 is plotted in the choropleth to show a general trend of the country-scale distribution and the changing of the religious population.</p>
<p>The map is produced via “rworldmap” package, and the color is chosen from “RColorBrewer” package. The mapCountryData method is called to plot the spatial polygon data frame created. The legend of the map is created separately afterward using the addMapLegend function to make sure the numbers and letters could be controlled.</p>
<p>These graphs serve to show the spatial distribution of the population of different religions.</p>
<div id="islam-1" class="section level3">
<h3>Islam</h3>
<p>The choropleth graphs show a general stable spatial distribution of Islam while it is still noticeable that U.S. and western Europe Muslim population will experience almost the most apparent increasing. Following by Australia and South America countries (e.g., Brazile), who also show enormous expanding in their muslim community.</p>
<pre class="r"><code>#Loading the Color Palette for Map
color1 &lt;- brewer.pal(5,&quot;YlOrRd&quot;)
# Plotting the Country Heat Map of Muslim Population in 2010
map1 &lt;- mapCountryData(islam_2010_plot, 
               nameColumnToPlot = &quot;value&quot;, 
               mapTitle = &quot;2010 World Muslim Population&quot;, 
               catMethod = &quot;logFixedWidth&quot;,
               colourPalette = color1,
               addLegend = FALSE)
#add legend 
do.call(addMapLegend, c(map1,
                        legendLabels=&quot;all&quot;,
                        labelFontSize = 0.5,
                        legendIntervals = &quot;page&quot;,
                        digits = 4,
                        sigFigs = 4
                        ))</code></pre>
<div class="figure">
<img src="index_files/figure-html/unnamed-chunk-8-1.png" alt="Country Heat Map of Muslim Population in 2010" width="672" />
<p class="caption">
Country Heat Map of Muslim Population in 2010
</p>
</div>
<pre class="r"><code># Plotting the Country Heat Map of Muslim Population in 2050


map2 &lt;- mapCountryData(islam_2050_plot, 
               nameColumnToPlot = &quot;value&quot;, 
               mapTitle = &quot;2050 World Muslim Population&quot;, 
               catMethod = &quot;logFixedWidth&quot;,
               colourPalette = color1,
               addLegend = FALSE)
do.call(addMapLegend, c(map2,legendLabels=&quot;all&quot;,labelFontSize = 0.5,legendIntervals = &quot;page&quot;,digits = 4,sigFigs = 4))</code></pre>
<div class="figure">
<img src="index_files/figure-html/unnamed-chunk-9-1.png" alt="Country Heat Map of Muslim Population in 2050" width="672" />
<p class="caption">
Country Heat Map of Muslim Population in 2050
</p>
</div>
</div>
<div id="christian" class="section level3">
<h3>Christian</h3>
<p>The following two plots show that Christianity population remains its spatial distribution in the coming decades while Canada and northern Europe countries will have a relatively slow increasing speed in their Christian people comparing to the other countries. It could be caused by the low birth rate in these areas and the general population growth in different places.</p>
<pre class="r"><code># Plotting the Country Heat Map of Christian Population in 2010


map2 &lt;- mapCountryData(chris_2010_plot, 
               nameColumnToPlot = &quot;value&quot;, 
               mapTitle = &quot;2010 World Christian Population&quot;, 
               catMethod = &quot;logFixedWidth&quot;,
               colourPalette = color1,
               addLegend = FALSE)
do.call(addMapLegend, c(map2,legendLabels=&quot;all&quot;,labelFontSize = 0.5,legendIntervals = &quot;page&quot;,digits = 4,sigFigs = 4))</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<pre class="r"><code># Plotting the Country Heat Map of Christian Population in 2050


map2 &lt;- mapCountryData(chris_2050_plot, 
               nameColumnToPlot = &quot;value&quot;, 
               mapTitle = &quot;2050 World Christian Population&quot;, 
               catMethod = &quot;logFixedWidth&quot;,
               colourPalette = color1,
               addLegend = FALSE)
do.call(addMapLegend, c(map2,legendLabels=&quot;all&quot;,labelFontSize = 0.5,legendIntervals = &quot;page&quot;,digits = 4,sigFigs = 4))</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
</div>
<div id="buddhism" class="section level3">
<h3>Buddhism</h3>
<p>The Buddhism belief keeps its distribution and population in general, from the following graphs. The only changing could be noticed is that southern and eastern Europe countries seem to have the most obvious expanding in Buddhism population among neighbor regions. The static in the expanding could be related to the doctrine of Buddhism, which, unlike Christianity and Islam, does not consider missionary activity to be important in its belief system.</p>
<pre class="r"><code># Plotting the Country Heat Map of Buddhism Population in 2010


map2 &lt;- mapCountryData(buddha_2010_plot, 
               nameColumnToPlot = &quot;value&quot;, 
               mapTitle = &quot;2010 World Buddhism Population&quot;, 
               catMethod = &quot;logFixedWidth&quot;,
               colourPalette = color1,
               addLegend = FALSE)
do.call(addMapLegend, c(map2,legendLabels=&quot;all&quot;,labelFontSize = 0.5,legendIntervals = &quot;page&quot;,digits = 4,sigFigs = 4))</code></pre>
<div class="figure">
<img src="index_files/figure-html/unnamed-chunk-12-1.png" alt="Country Heat Map of Buddhism Population in 2010" width="672" />
<p class="caption">
Country Heat Map of Buddhism Population in 2010
</p>
</div>
<pre class="r"><code># Plotting the Country Heat Map of Buddhism Population in 2050

map2 &lt;- mapCountryData(buddha_2050_plot, 
               nameColumnToPlot = &quot;value&quot;, 
               mapTitle = &quot;2050 World Buddhism Population&quot;, 
               catMethod = &quot;logFixedWidth&quot;,
               colourPalette = color1,
               addLegend = FALSE)
do.call(addMapLegend, c(map2,legendLabels=&quot;all&quot;,labelFontSize = 0.5,legendIntervals = &quot;page&quot;,digits = 4,sigFigs = 4))</code></pre>
<div class="figure">
<img src="index_files/figure-html/unnamed-chunk-13-1.png" alt="Country Heat Map of Buddhism Population in 2050" width="672" />
<p class="caption">
Country Heat Map of Buddhism Population in 2050
</p>
</div>
</div>
<div id="religiously-unaffiiated" class="section level3">
<h3>Religiously Unaffiiated</h3>
<p>The non-religion population remains its distribution while Brazile seems to have an obvious increasement in its skeptic population.</p>
<pre class="r"><code># Plotting the Country Heat Map of Religious Unaffiiated Population in 2010


map2 &lt;- mapCountryData(unaffiliated_2010_plot, 
               nameColumnToPlot = &quot;value&quot;, 
               mapTitle = &quot;2010 World Religiously Unaffiliated Population&quot;, 
               catMethod = &quot;logFixedWidth&quot;,
               colourPalette = color1,
               addLegend = FALSE)
do.call(addMapLegend, c(map2,legendLabels=&quot;all&quot;,labelFontSize = 0.5,legendIntervals = &quot;page&quot;,digits = 4,sigFigs = 4))</code></pre>
<div class="figure">
<img src="index_files/figure-html/unnamed-chunk-14-1.png" alt="Country Heat Map of Religious Unaffiiated Population in 2010" width="672" />
<p class="caption">
Country Heat Map of Religious Unaffiiated Population in 2010
</p>
</div>
<pre class="r"><code># Plotting the Country Heat Map of Religious Unaffiiated Population in 2050

map2 &lt;- mapCountryData(unaffiliated_2050_plot, 
               nameColumnToPlot = &quot;value&quot;, 
               mapTitle = &quot;2050 World Religiously Unaffiliated Population&quot;, 
               catMethod = &quot;logFixedWidth&quot;,
               colourPalette = color1,
               addLegend = FALSE)
do.call(addMapLegend, c(map2,legendLabels=&quot;all&quot;,labelFontSize = 0.5,legendIntervals = &quot;page&quot;,digits = 4,sigFigs = 4))</code></pre>
<div class="figure">
<img src="index_files/figure-html/unnamed-chunk-15-1.png" alt="Country Heat Map of Religious Unaffiiated Population in 2050" width="672" />
<p class="caption">
Country Heat Map of Religious Unaffiiated Population in 2050
</p>
</div>
</div>
</div>
<div id="pie-chart" class="section level2">
<h2>Pie Chart</h2>
</div>
<div id="section-3" class="section level2 tabset">
<h2></h2>
<p>In this page, the pie chart representing the population proportion of different religion in each country from 2010 to 2050 is produced.</p>
<p>The population value in spatial polygon data frames for every religion in each year is retrieved and combined into a new spatial data frame. Then plotted via mapPies() function provided by the rworldmap package.</p>
<p>These pie charts aim to provide a country leveled proportion of the population of different religions. Also, the size of the circle in the graphs represents the number of population in each country, which helps to make the global population growth into the count.</p>
<p>These pie charts show a trend that religiously unaffiliated population is increasing in the coming decades, which, is contradicted to what Timothy Keller predicted in her book “The Reason for God.”</p>
<div id="section-4" class="section level3">
<h3>2010</h3>
<pre class="r"><code>#2010
pie_2010_plot &lt;- islam_2010_plot
pie_2010_plot$Islam &lt;- islam_2010_plot$value
pie_2010_plot$Christian &lt;- chris_2010_plot$value
pie_2010_plot$Buddha &lt;- buddha_2010_plot$value
pie_2010_plot$Unaffiliated &lt;- unaffiliated_2010_plot$value

mapPies(pie_2010_plot, 
        nameZs = c(&#39;Islam&#39;,&#39;Christian&#39;,&#39;Buddha&#39;,&#39;Unaffiliated&#39;),
        zColours = c(&#39;dark green&#39;,&#39;purple&#39;,&#39;red&#39;,&#39;blue&#39;),
        oceanCol = &#39;light blue&#39;,
        landCol = &#39;wheat&#39;,
        symbolSize = 2.6)</code></pre>
<pre><code>## symbolMaxSize= 7.2  maxSumValues= 1037890000  symbolScale= 0.0002234894 
## List of 2
##  $ x: num [1:100] -138 -138 -138 -139 -139 ...
##  $ y: num [1:100] 66 67.2 68.4 69.6 70.7 ...</code></pre>
<pre class="r"><code>title(&quot;2010 World Religious Population Pie Chart&quot;)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
</div>
<div id="section-5" class="section level3">
<h3>2020</h3>
<pre class="r"><code>#2020
pie_2020_plot &lt;- islam_2020_plot
pie_2020_plot$Islam &lt;- islam_2020_plot$value
pie_2020_plot$Christian &lt;- chris_2020_plot$value
pie_2020_plot$Buddha &lt;- buddha_2020_plot$value
pie_2020_plot$Unaffiliated &lt;- unaffiliated_2020_plot$value

mapPies(pie_2020_plot, 
        nameZs = c(&#39;Islam&#39;,&#39;Christian&#39;,&#39;Buddha&#39;,&#39;Unaffiliated&#39;),
        zColours = c(&#39;dark green&#39;,&#39;purple&#39;,&#39;red&#39;,&#39;blue&#39;),
        oceanCol = &#39;light blue&#39;,
        landCol = &#39;wheat&#39;,
        symbolSize = 2.6)</code></pre>
<pre><code>## symbolMaxSize= 7.2  maxSumValues= 1075220000  symbolScale= 0.0002195755 
## List of 2
##  $ x: num [1:100] -138 -138 -138 -139 -139 ...
##  $ y: num [1:100] 66 67.2 68.4 69.6 70.7 ...</code></pre>
<pre class="r"><code>title(&quot;2020 World Religious Population Pie Chart&quot;)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
</div>
<div id="section-6" class="section level3">
<h3>2030</h3>
<pre class="r"><code>#2030
pie_2030_plot &lt;- islam_2030_plot
pie_2030_plot$Islam &lt;- islam_2030_plot$value
pie_2030_plot$Christian &lt;- chris_2030_plot$value
pie_2030_plot$Buddha &lt;- buddha_2030_plot$value
pie_2030_plot$Unaffiliated &lt;- unaffiliated_2030_plot$value

mapPies(pie_2030_plot, 
        nameZs = c(&#39;Islam&#39;,&#39;Christian&#39;,&#39;Buddha&#39;,&#39;Unaffiliated&#39;),
        zColours = c(&#39;dark green&#39;,&#39;purple&#39;,&#39;red&#39;,&#39;blue&#39;),
        oceanCol = &#39;light blue&#39;,
        landCol = &#39;wheat&#39;,
        symbolSize = 2.6)</code></pre>
<pre><code>## symbolMaxSize= 7.2  maxSumValues= 1081150000  symbolScale= 0.0002189725 
## List of 2
##  $ x: num [1:100] -138 -138 -138 -139 -139 ...
##  $ y: num [1:100] 66 67.2 68.4 69.6 70.7 ...</code></pre>
<pre class="r"><code>title(&quot;2030 World Religious Population Pie Chart&quot;)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
</div>
<div id="section-7" class="section level3">
<h3>2040</h3>
<pre class="r"><code>pie_2040_plot &lt;- islam_2040_plot
pie_2040_plot$Islam &lt;- islam_2040_plot$value
pie_2040_plot$Christian &lt;- chris_2040_plot$value
pie_2040_plot$Buddha &lt;- buddha_2040_plot$value
pie_2040_plot$Unaffiliated &lt;- unaffiliated_2040_plot$value

mapPies(pie_2040_plot, 
        nameZs = c(&#39;Islam&#39;,&#39;Christian&#39;,&#39;Buddha&#39;,&#39;Unaffiliated&#39;),
        zColours = c(&#39;dark green&#39;,&#39;purple&#39;,&#39;red&#39;,&#39;blue&#39;),
        oceanCol = &#39;light blue&#39;,
        landCol = &#39;wheat&#39;,
        symbolSize = 2.6)</code></pre>
<pre><code>## symbolMaxSize= 7.2  maxSumValues= 1058490000  symbolScale= 0.0002213039 
## List of 2
##  $ x: num [1:100] -138 -138 -138 -139 -139 ...
##  $ y: num [1:100] 66 67.2 68.4 69.6 70.7 ...</code></pre>
<pre class="r"><code>title(&quot;2040 World Religious Population Pie Chart&quot;)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
</div>
<div id="section-8" class="section level3">
<h3>2050</h3>
<pre class="r"><code>#2050
pie_2050_plot &lt;- islam_2050_plot
pie_2050_plot$Islam &lt;- islam_2050_plot$value
pie_2050_plot$Christian &lt;- chris_2050_plot$value
pie_2050_plot$Buddha &lt;- buddha_2050_plot$value
pie_2050_plot$Unaffiliated &lt;- unaffiliated_2050_plot$value

mapPies(pie_2050_plot, 
        nameZs = c(&#39;Islam&#39;,&#39;Christian&#39;,&#39;Buddha&#39;,&#39;Unaffiliated&#39;),
        zColours = c(&#39;dark green&#39;,&#39;purple&#39;,&#39;red&#39;,&#39;blue&#39;),
        oceanCol = &#39;light blue&#39;,
        landCol = &#39;wheat&#39;,
        symbolSize = 2.6)</code></pre>
<pre><code>## symbolMaxSize= 7.2  maxSumValues= 1010750000  symbolScale= 0.00022647 
## List of 2
##  $ x: num [1:100] -138 -138 -138 -139 -139 ...
##  $ y: num [1:100] 66 67.2 68.4 69.6 70.7 ...</code></pre>
<pre class="r"><code>title(&quot;2050 World Religious Population Pie Chart&quot;)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
</div>
</div>
<div id="bar-plot" class="section level2">
<h2>Bar Plot</h2>
<p>Using barplotCountryData() function in the rworldmap package, the bar plot representing the relative religious population for each country is created in this page. These bar plots serve to answer the question that whether the country ranking of the population in a specific religion changed from 2010 to 2050.</p>
<div id="islam-2" class="section level3">
<h3>Islam</h3>
</div>
<div id="section-9" class="section level3 tabset">
<h3></h3>
<div id="section-10" class="section level4">
<h4>2010</h4>
<p><img src="index_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
</div>
<div id="section-11" class="section level4">
<h4>2020</h4>
<p><img src="index_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
</div>
<div id="section-12" class="section level4">
<h4>2030</h4>
<p><img src="index_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
</div>
<div id="section-13" class="section level4">
<h4>2040</h4>
<p><img src="index_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="section-14" class="section level4">
<h4>2050</h4>
<p><img src="index_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
</div>
</div>
<div id="christianity-1" class="section level3">
<h3>Christianity</h3>
</div>
<div id="section-15" class="section level3 tabset">
<h3></h3>
<div id="section-16" class="section level4">
<h4>2010</h4>
<p><img src="index_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
</div>
<div id="section-17" class="section level4">
<h4>2020</h4>
<p><img src="index_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
</div>
<div id="section-18" class="section level4">
<h4>2030</h4>
<p><img src="index_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
</div>
<div id="section-19" class="section level4">
<h4>2040</h4>
<p><img src="index_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>
</div>
<div id="section-20" class="section level4">
<h4>2050</h4>
<p><img src="index_files/figure-html/unnamed-chunk-30-1.png" width="672" /></p>
</div>
</div>
<div id="buddhism-1" class="section level3">
<h3>Buddhism</h3>
</div>
<div id="section-21" class="section level3 tabset">
<h3></h3>
<div id="section-22" class="section level4">
<h4>2010</h4>
<p><img src="index_files/figure-html/unnamed-chunk-31-1.png" width="672" /></p>
</div>
<div id="section-23" class="section level4">
<h4>2020</h4>
<p><img src="index_files/figure-html/unnamed-chunk-32-1.png" width="672" /></p>
</div>
<div id="section-24" class="section level4">
<h4>2030</h4>
<p><img src="index_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>
</div>
<div id="section-25" class="section level4">
<h4>2040</h4>
<p><img src="index_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>
</div>
<div id="section-26" class="section level4">
<h4>2050</h4>
<p><img src="index_files/figure-html/unnamed-chunk-35-1.png" width="672" /></p>
</div>
</div>
<div id="religiously-unaffiliated-1" class="section level3">
<h3>Religiously Unaffiliated</h3>
</div>
<div id="section-27" class="section level3 tabset">
<h3></h3>
<div id="section-28" class="section level4">
<h4>2010</h4>
<p><img src="index_files/figure-html/unnamed-chunk-36-1.png" width="672" /></p>
</div>
<div id="section-29" class="section level4">
<h4>2020</h4>
<p><img src="index_files/figure-html/unnamed-chunk-37-1.png" width="672" /></p>
</div>
<div id="section-30" class="section level4">
<h4>2030</h4>
<p><img src="index_files/figure-html/unnamed-chunk-38-1.png" width="672" /></p>
</div>
<div id="section-31" class="section level4">
<h4>2040</h4>
<p><img src="index_files/figure-html/unnamed-chunk-39-1.png" width="672" /></p>
</div>
<div id="section-32" class="section level4">
<h4>2050</h4>
<p><img src="index_files/figure-html/unnamed-chunk-40-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="line-chart" class="section level2">
<h2>Line Chart</h2>
</div>
<div id="section-33" class="section level2 tabset">
<h2></h2>
<p>**TO BE CONTINUED</p>
<div id="islam-3" class="section level3">
<h3>Islam</h3>
</div>
<div id="christianity-2" class="section level3">
<h3>Christianity</h3>
</div>
<div id="buddhism-2" class="section level3">
<h3>Buddhism</h3>
</div>
<div id="unaffiliated" class="section level3">
<h3>Unaffiliated</h3>
</div>
</div>
<div id="percentage-pie-chart" class="section level2">
<h2>Percentage Pie Chart</h2>
<p>**TO BE CONTINUED</p>
</div>
</div>
<div id="conclusions" class="section level1">
<h1>Conclusions</h1>
<p>In conclusion, Islam world would experience the most evident increasing in its follower community. Which will make it have a comparable population with the dominant religion, Christianity. Also, the following decades may witness the expanding of the territory of Islam, which is most likely to be happening in western Europe, western and northern Africa and Russia. Unlike what Timothy Keller had predicted, atheist population keeps increasing in almost the entire world except for China. The most apparent decline in the proportion of non-religion population may happen in the biggest non-religion country in 2010, China, where will witness the growth of Christianity, Islam and Buddhism population. As for Buddhism, which is not famous for its missionary stories, remains its territory and population in eastern Asia.</p>
<p>Furthermore, it worths broader study about the expanding of different belief ideas. From Abrahamic religions to the Hindu-originated religion, then the Marxism, the spatial distribution of each religion’s territory may display a relation with the society or time when it was expanded. Just like the colonization of Europeans developed the intelligence of Paul the Apostle, the Ocean trading spread the wisdom in Koran. How would different religions grow in the future where the world has advanced transportation and opened immigration policies?</p>
</div>
<div id="references" class="section level1">
<h1>References</h1>
<p>Saxe, L. and E. Tighe (2013). “Estimating and Understanding the Jewish Population in the United States: A Program of Research.” Contemporary Jewry 33(1): 43-62.</p>
<p>Keller, T. J. (2008). The reason for God: Belief in an age of skepticism. New York: Dutton.</p>
</div>

<!-- give the footer some space -->
<br/>
<br/>

<footer id="site-footer">
  <div id="footer1">
  This website is a project for Adam Wilson's <a href="http://www.adamwilson.us/RDataScience"><i> Spatial Data Science (GEO503) </i></a>Course at the University at Buffalo
  </div>
  <div id="footer2">
  <a rel="license" property="http://creativecommons.org/ns#license"
  href="http://creativecommons.org/licenses/by/4.0/" ><img src="img/cc-by.svg" alt="cc-by"/></a> 
  </div>
</footer>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>


</body>
</html>
